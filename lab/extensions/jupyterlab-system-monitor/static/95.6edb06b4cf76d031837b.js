(self.webpackChunkjupyterlab_system_monitor=self.webpackChunkjupyterlab_system_monitor||[]).push([[95],{901:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CpuView:()=>u,MemoryView:()=>h,ResourceUsage:()=>M});var i=r(520),a=r(271),n=r.n(a),s=r(311);const l=({percentage:e,color:t})=>n().createElement("div",{className:"jp-IndicatorFiller",style:{width:100*e+"%",background:`${t}`}}),c=({values:e,percentage:t,baseColor:r})=>{const[i,c]=(0,a.useState)(!1),o=t>.5?t>.8?"red":"orange":r;return n().createElement("div",{className:"jp-IndicatorBar",onClick:()=>{c(!i)}},i&&n().createElement(s.Sparklines,{data:e,min:0,max:1,limit:e.length,margin:0},n().createElement(s.SparklinesLine,{style:{stroke:o,strokeWidth:4,fill:o,fillOpacity:1}}),n().createElement(s.SparklinesSpots,null)),!i&&n().createElement(l,{percentage:t,color:o}))},o=({enabled:e,values:t,label:r,color:i,text:a})=>{const s=t[t.length-1];return e&&n().createElement("div",{className:"jp-IndicatorContainer"},n().createElement("div",{className:"jp-IndicatorText"},r),null!==s&&n().createElement("div",{className:"jp-IndicatorWrapper"},n().createElement(c,{values:t,percentage:s,baseColor:i})),n().createElement("div",{className:"jp-IndicatorText"},a))},m=({model:e,label:t})=>{const[r,i]=(0,a.useState)(""),[s,l]=(0,a.useState)([]),c=()=>{const{currentCpuPercent:t}=e,r=e.values.map((e=>e.cpuPercent)),a=`${(100*t).toFixed(0)}%`;i(a),l(r)};return(0,a.useEffect)((()=>(e.changed.connect(c),()=>{e.changed.disconnect(c)})),[e]),n().createElement(o,{enabled:e.cpuAvailable,values:s,label:t,color:"#0072B3",text:r})};var u;!function(e){e.createCpuView=(e,t)=>i.ReactWidget.create(n().createElement(m,{model:e,label:t}))}(u||(u={}));const _=({model:e,label:t})=>{const[r,i]=(0,a.useState)(""),[s,l]=(0,a.useState)([]),c=()=>{const{memoryLimit:t,currentMemory:r,units:a}=e,n=["B","KB","MB"].indexOf(a)>0?0:2,s=`${r.toFixed(n)} ${t?"/ "+t.toFixed(n):""} ${a}`,c=e.values.map((e=>e.memoryPercent));i(s),l(c)};return(0,a.useEffect)((()=>(e.changed.connect(c),()=>{e.changed.disconnect(c)})),[e]),n().createElement(o,{enabled:e.memoryAvailable,values:s,label:t,color:"#00B35B",text:r})};var h;!function(e){e.createMemoryView=(e,t)=>i.ReactWidget.create(n().createElement(_,{model:e,label:t}))}(h||(h={}));var M,p,d=r(629),I=r(683),v=r(361),y=r(168);!function(e){e.Model=class{constructor(e){this._memoryAvailable=!1,this._cpuAvailable=!1,this._currentMemory=0,this._currentCpuPercent=0,this._memoryLimit=null,this._units="B",this._changed=new y.Signal(this),this._values=[];for(let e=0;e<20;e++)this._values.push({memoryPercent:0,cpuPercent:0});this._poll=new v.n_({factory:()=>p.factory(),frequency:{interval:e.refreshRate,backoff:!0},name:"jupyterlab-system-monitor:ResourceUsage#metrics"}),this._poll.ticked.connect((e=>{const{payload:t,phase:r}=e.state;if("resolved"!==r){if("rejected"===r){const e=this._memoryAvailable,t=this._cpuAvailable;return this._memoryAvailable=!1,this._cpuAvailable=!1,this._currentMemory=0,this._memoryLimit=null,this._units="B",void((e||t)&&this._changed.emit())}}else this._updateMetricsValues(t)}))}async refresh(){await this._poll.refresh(),await this._poll.tick}get memoryAvailable(){return this._memoryAvailable}get cpuAvailable(){return this._cpuAvailable}get currentMemory(){return this._currentMemory}get memoryLimit(){return this._memoryLimit}get units(){return this._units}get currentCpuPercent(){return this._currentCpuPercent}get changed(){return this._changed}get values(){return this._values}dispose(){this._poll.dispose()}_updateMetricsValues(e){if(null===e)return this._memoryAvailable=!1,this._cpuAvailable=!1,this._currentMemory=0,this._memoryLimit=null,void(this._units="B");const t=e.rss,r=e.limits.memory?e.limits.memory.rss:null,[i,a]=p.convertToLargestUnit(t);this._memoryAvailable=void 0!==t,this._currentMemory=i,this._units=a,this._memoryLimit=r?r/p.MEMORY_UNIT_LIMITS[a]:null;const n=this.memoryLimit?Math.min(this._currentMemory/this.memoryLimit,1):null,s=e.cpu_percent;this._cpuAvailable=void 0!==s,this._currentCpuPercent=this._cpuAvailable?Math.min(1,s/100):0,this._values.push({memoryPercent:n,cpuPercent:this._currentCpuPercent}),this._values.shift(),this._changed.emit(void 0)}}}(M||(M={})),function(e){e.DECIMAL_PLACES=2,e.MEMORY_UNIT_LIMITS={B:1,KB:1024,MB:1048576,GB:1073741824,TB:1099511627776,PB:0x4000000000000},e.convertToLargestUnit=t=>t<e.MEMORY_UNIT_LIMITS.KB?[t,"B"]:e.MEMORY_UNIT_LIMITS.KB===t||t<e.MEMORY_UNIT_LIMITS.MB?[t/e.MEMORY_UNIT_LIMITS.KB,"KB"]:e.MEMORY_UNIT_LIMITS.MB===t||t<e.MEMORY_UNIT_LIMITS.GB?[t/e.MEMORY_UNIT_LIMITS.MB,"MB"]:e.MEMORY_UNIT_LIMITS.GB===t||t<e.MEMORY_UNIT_LIMITS.TB?[t/e.MEMORY_UNIT_LIMITS.GB,"GB"]:e.MEMORY_UNIT_LIMITS.TB===t||t<e.MEMORY_UNIT_LIMITS.PB?[t/e.MEMORY_UNIT_LIMITS.TB,"TB"]:[t/e.MEMORY_UNIT_LIMITS.PB,"PB"];const t=I.ServerConnection.makeSettings(),r=d.URLExt.join(t.baseUrl,"api/metrics/v1");e.factory=async()=>{const e=I.ServerConnection.makeRequest(r,{},t),i=await e;return i.ok?await i.json():null}}(p||(p={}))}}]);